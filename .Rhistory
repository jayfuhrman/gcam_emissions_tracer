if_else(input == 'delivered gas','gas processing',NA_character_))) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name'))
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)))
View(trn_inputs_by_subsector)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
summarize(all_tailpipe = sum(tailpipe_emiss))
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
summarize(value = tailpipe_emiss / sum(tailpipe_emiss))
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
summarize(value = tailpipe_emiss / sum(tailpipe_emiss))
View(trn_inputs_by_subsector)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,transformation,year) %>%
summarize(value = tailpipe_emiss / sum(tailpipe_emiss))
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,transformation,year) %>%
summarize(value = sum(tailpipe_emiss))
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,transformation,year) %>%
summarize(sum_emiss = sum(tailpipe_emiss)) %>%
ungroup()
View(trn_tmp)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,transformation,year)
View(trn_inputs_by_subsector)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) #%>%
mutate(frac_tailpipe_emiss = tailpipe_emiss/sum(tailpipe_emiss)) %>%
ungroup()
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
value = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) #%>%
mutate(frac_tailpipe_emiss = value / sum(value)) %>%
ungroup()
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
mutate(frac_tailpipe_emiss = tailpipe_emiss / sum(tailpipe_emiss)) %>%
ungroup()
View(trn_tmp)
View(trn_inputs_by_subsector)
View(trn_inputs_by_subsector)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
mutate(frac_tailpipe_emiss = tailpipe_emiss / sum(tailpipe_emiss)) %>%
ungroup() %>%
select(-sector,-PrimaryFuelCO2Coef.name,-value,-PrimaryFuelCO2Coef,-fuel,-tailpipe_emiss)
View(trn_inputs_by_subsector)
View(trn_CO2)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
mutate(frac_tailpipe_emiss = tailpipe_emiss / sum(tailpipe_emiss)) %>%
ungroup() %>%
select(-sector,-PrimaryFuelCO2Coef.name,-value,-PrimaryFuelCO2Coef,-fuel,-tailpipe_emiss,-Units)
View(trn_tmp)
View(trn_CO2)
View(trn_CO2)
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','transformation','enduse','year')) -> trn_CO2_joined
View(trn_CO2_joined)
trn_CO2 %>%
left_join(trn_inputs_by_subsector,by = c('scenario','region','transformation','enduse','year')) -> trn_CO2_joined
View(trn_CO2_joined)
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) -> trn_CO2_joined
View(trn_inputs_by_subsector)
View(trn_CO2_joined)
all_emiss_no_elec_CO2 %>%
filter(direct %in% transport_sectors$transportation_subsector & ghg == 'CO2') %>%
select(-transformation)-> trn_CO2
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
mutate(frac_tailpipe_emiss = tailpipe_emiss / sum(tailpipe_emiss)) %>%
ungroup() %>%
select(-sector,-PrimaryFuelCO2Coef.name,-value,-PrimaryFuelCO2Coef,-fuel,-tailpipe_emiss,-Units)
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) -> trn_CO2_joined
View(trn_CO2_joined)
trn_CO2 %>%
left_join(trn_inputs_by_subsector,by = c('scenario','region','enduse','year')) -> trn_CO2_joined]
trn_CO2 %>%
left_join(trn_inputs_by_subsector,by = c('scenario','region','enduse','year')) -> trn_CO2_joined
View(trn_CO2_joined)
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) -> trn_CO2_joined
View(trn_CO2_joined)
View(trn_CO2_joined)
View(trn_CO2_joined)
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) %>%
mutate(value = value * frac_tailpipe_emiss) -> trn_CO2_joined
View(trn_inputs_by_subsector)
View(trn_CO2_joined)
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) %>%
mutate(value = value * frac_tailpipe_emiss) %>%
select(-frac_tailpipe_emiss) -> trn_CO2_joined
View(trn_CO2_joined)
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) %>%
mutate(value = value * frac_tailpipe_emiss,
fuel = if_else(transformation == 'refining','refining',
if_else(transformation = 'gas processing','natural gas',NA_character_))) %>%
select(-frac_tailpipe_emiss) -> trn_CO2_joined
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) %>%
mutate(value = value * frac_tailpipe_emiss,
fuel = if_else(transformation == 'refining','refining',
if_else(transformation == 'gas processing','natural gas',NA_character_))) %>%
select(-frac_tailpipe_emiss) -> trn_CO2_joined
View(trn_CO2_joined)
View(trn_CO2)
View(trn_CO2_joined)
write.csv(trn_CO2_joined,'trn_CO2_joined.csv')
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) %>%
mutate(value = value * frac_tailpipe_emiss,
fuel = if_else(transformation == 'refining','refining',
if_else(transformation == 'gas processing','natural gas',NA_character_))) %>%
select(-frac_tailpipe_emiss) %>%
filter(year >= 2005)-> trn_CO2_joined
write.csv(trn_CO2_joined,'trn_CO2_joined.csv')
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) %>%
mutate(value = value * frac_tailpipe_emiss,
fuel = if_else(transformation == 'refining','refining',
if_else(transformation == 'gas processing','natural gas',NA_character_)),
direct = fuel) %>%
select(-frac_tailpipe_emiss) %>%
filter(year >= 2005)-> trn_CO2_joined
write.csv(trn_CO2_joined,'trn_CO2_joined.csv')
write.csv(trn_tailpipe_CO2_joined,'trn_tailpipe_CO2_joined.csv')
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) %>%
mutate(value = value * frac_tailpipe_emiss,
fuel = if_else(transformation == 'refining','refining',
if_else(transformation == 'gas processing','natural gas',NA_character_)),
direct = fuel) %>%
select(-frac_tailpipe_emiss) %>%
filter(year >= 2005)-> trn_tailpipe_CO2_joined
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) %>%
mutate(value = value * frac_tailpipe_emiss,
fuel = if_else(transformation == 'refining','refining',
if_else(transformation == 'gas processing','natural gas',NA_character_)),
direct = fuel) %>%
select(-frac_tailpipe_emiss) %>%
filter(year >= 2005)-> trn_tailpipe_CO2_joined
write.csv(trn_tailpipe_CO2_joined,'trn_tailpipe_CO2_joined.csv')
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) %>%
mutate(value = value * frac_tailpipe_emiss,
fuel = if_else(transformation == 'refining','refining',
if_else(transformation == 'gas processing','natural gas',NA_character_)),
direct = fuel) %>%
select(-frac_tailpipe_emiss,-fuel) %>%
filter(year >= 2005)-> trn_tailpipe_CO2_joined
write.csv(trn_tailpipe_CO2_joined,'trn_tailpipe_CO2_joined.csv')
inputs_by_subsector %>%
filter(input %in% c('refined liquids','refined liquids enduse')) -> refined_liquids_subsector
View(refined_liquids_subsector)
write.csv(refined_liquids_subsector,'refined_liquids_subsector.csv')
inputs_by_subsector %>%
filter(input %in% c('refined liquids industrial','refined liquids enduse')) -> refined_liquids_subsector
write.csv(refined_liquids_subsector,'refined_liquids_subsector.csv')
inputs_by_subsector %>%
filter(input %in% c('refined liquids industrial','refined liquids enduse')) %>%
mutate(subsector = if_else(subsector == 'refined liquids',sector,subsector))-> refined_liquids_subsector
write.csv(refined_liquids_subsector,'refined_liquids_subsector.csv')
unique(refined_liquids_subsector$subsector)
inputs_by_subsector %>%
filter(input %in% c('refined liquids industrial','refined liquids enduse'),
!(sector %in% c('elec_refined liquids (CC)','elec_refined liquids (CC)','elec_refined liquids (steam/CT)'))) %>%
mutate(subsector = if_else(subsector == 'refined liquids',sector,subsector)) -> refined_liquids_subsector
write.csv(refined_liquids_subsector,'refined_liquids_subsector.csv')
inputs_by_subsector %>%
filter(input %in% c('refined liquids industrial','refined liquids enduse'),
!(sector %in% c('elec_refined liquids (CC)','elec_refined liquids (CC CCS)','elec_refined liquids (steam/CT)'))) %>%
mutate(subsector = if_else(subsector == 'refined liquids',sector,subsector)) -> refined_liquids_subsector
inputs_by_subsector %>%
filter(input %in% c('refined liquids industrial','refined liquids enduse'),
!(sector %in% c('elec_refined liquids (CC)','elec_refined liquids (CC CCS)','elec_refined liquids (steam/CT)'))) %>%
mutate(subsector = if_else(subsector == 'refined liquids',sector,subsector)) %>%
distinct(subsector)-> refined_liquids_subsector
View(refined_liquids_subsector)
write.csv(refined_liquids_subsector,'refined_liquids_subsector.csv')
write.csv(refined_liquids_subsector,'refined_liquids_subsector.csv')
inputs_by_subsector %>%
filter(input %in% c('refined liquids industrial','refined liquids enduse'),
!(sector %in% c('elec_refined liquids (CC)','elec_refined liquids (CC CCS)','elec_refined liquids (steam/CT)'))) %>%
mutate(subsector = if_else(subsector == 'refined liquids',sector,subsector)) %>%
distinct(subsector)-> refined_liquids_subsectors
all_emiss_no_elec_CO2 %>%
filter(direct %in% refined_liquids_subsectors$subsector & ghg == 'CO2') %>%
select(-transformation)-> trn_CO2
## Filter to get fuels with tailpipe emissions (i.e., natural gas + refined liquids)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% refined_liquids_subsectors$subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
mutate(frac_tailpipe_emiss = tailpipe_emiss / sum(tailpipe_emiss)) %>%
ungroup() %>%
select(-sector,-PrimaryFuelCO2Coef.name,-value,-PrimaryFuelCO2Coef,-fuel,-tailpipe_emiss,-Units)
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) %>%
mutate(value = value * frac_tailpipe_emiss,
fuel = if_else(transformation == 'refining','refining',
if_else(transformation == 'gas processing','natural gas',NA_character_)),
direct = fuel) %>%
select(-frac_tailpipe_emiss,-fuel) %>%
filter(year >= 2005)-> trn_tailpipe_CO2_joined
write.csv(trn_tailpipe_CO2_joined,'trn_tailpipe_CO2_joined.csv')
View(trn_CO2)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% refined_liquids_subsectors$subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
mutate(frac_tailpipe_emiss = tailpipe_emiss / sum(tailpipe_emiss)) %>%
ungroup() %>%
select(-sector,-PrimaryFuelCO2Coef.name,-value,-PrimaryFuelCO2Coef,-fuel,-tailpipe_emiss,-Units)
View(trn_inputs_by_subsector)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% refined_liquids_subsectors$subsector,
input %in% c('refined liquids enduse','delivered gas'))
View(trn_inputs_by_subsector)
source('~/GitHub/cwf_emissions_tracer/disagg_test.R', echo=TRUE)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector)
write.csv(trn_inputs_by_subsector,'trn_inputs_by_subsector.csv')
inputs_by_subsector %>%
filter(input %in% c('refined liquids industrial','refined liquids enduse'),
!(sector %in% c('elec_refined liquids (CC)','elec_refined liquids (CC CCS)','elec_refined liquids (steam/CT)'))) %>%
mutate(subsector = if_else(subsector == 'refined liquids',sector,subsector)) %>%
distinct(subsector)-> refined_liquids_subsector
View(refined_liquids_subsector)
View(refined_liquids_subsectors)
all_emiss_no_elec_CO2 %>%
filter(direct %in% inputs_by_subsector$subsector & ghg == 'CO2') %>%
select(-transformation)-> trn_CO2
View(trn_CO2)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% refined_liquids_subsector$subsector,
input %in% c('refined liquids enduse','delivered gas')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else(PrimaryFuelCO2Coef.name == 'refined liquids enduse','refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
mutate(frac_tailpipe_emiss = tailpipe_emiss / sum(tailpipe_emiss)) %>%
ungroup() %>%
select(-sector,-PrimaryFuelCO2Coef.name,-value,-PrimaryFuelCO2Coef,-fuel,-tailpipe_emiss,-Units)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% refined_liquids_subsector$subsector)
View(trn_inputs_by_subsector)
View(trn_CO2)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% refined_liquids_subsector$subsector,
input %in% c('refined liquids enduse','delivered gas','refined liquids industrial')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else((PrimaryFuelCO2Coef.name == 'refined liquids enduse' | PrimaryFuelCO2Coef.name == 'refined liquids industrial'),'refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
mutate(frac_tailpipe_emiss = tailpipe_emiss / sum(tailpipe_emiss)) %>%
ungroup() %>%
select(-sector,-PrimaryFuelCO2Coef.name,-value,-PrimaryFuelCO2Coef,-fuel,-tailpipe_emiss,-Units)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% refined_liquids_subsector$subsector,
input %in% c('refined liquids enduse','delivered gas','refined liquids industrial'))
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% refined_liquids_subsector$subsector,
input %in% c('refined liquids enduse','delivered gas','refined liquids industrial')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input)
View(trn_inputs_by_subsector)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% refined_liquids_subsector$subsector,
input %in% c('refined liquids enduse','delivered gas','refined liquids industrial')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else((PrimaryFuelCO2Coef.name == 'refined liquids enduse' | PrimaryFuelCO2Coef.name == 'refined liquids industrial'),'refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
mutate(frac_tailpipe_emiss = tailpipe_emiss / sum(tailpipe_emiss)) %>%
ungroup() %>%
select(-sector,-PrimaryFuelCO2Coef.name,-value,-PrimaryFuelCO2Coef,-fuel,-tailpipe_emiss,-Units)
View(trn_inputs_by_subsector)
source('~/GitHub/cwf_emissions_tracer/disagg_test.R', echo=TRUE)
source('~/GitHub/cwf_emissions_tracer/disagg_test.R', echo=TRUE)
write.csv(trn_inputs_by_subsector,'trn_inputs_by_subsector.csv')
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% refined_liquids_subsector$subsector) %>%#,
#         input %in% c('refined liquids enduse','delivered gas','refined liquids industrial')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else((PrimaryFuelCO2Coef.name == 'refined liquids enduse' | PrimaryFuelCO2Coef.name == 'refined liquids industrial'),'refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',transformation)),
tailpipe_emiss = value * PrimaryFuelCO2Coef)
trn_inputs_by_subsector <- inputs_by_subsector %>%
filter(subsector %in% transport_sectors$transportation_subsector,
input %in% c('refined liquids enduse','delivered gas','refined liquids industrial')) %>%
rename(enduse = subsector,
PrimaryFuelCO2Coef.name = input) %>%
left_join(ccoef_mapping,by = c('PrimaryFuelCO2Coef.name')) %>%
mutate(transformation = if_else((PrimaryFuelCO2Coef.name == 'refined liquids enduse' | PrimaryFuelCO2Coef.name == 'refined liquids industrial'),'refining',
if_else(PrimaryFuelCO2Coef.name == 'delivered gas','gas processing',NA_character_)),
tailpipe_emiss = value * PrimaryFuelCO2Coef) %>%
group_by(scenario,region,enduse,year) %>%
mutate(frac_tailpipe_emiss = tailpipe_emiss / sum(tailpipe_emiss)) %>%
ungroup() %>%
select(-sector,-PrimaryFuelCO2Coef.name,-value,-PrimaryFuelCO2Coef,-fuel,-tailpipe_emiss,-Units)
write.csv(trn_inputs_by_subsector,'trn_inputs_by_subsector.csv')
trn_inputs_by_subsector %>%
left_join(trn_CO2,by = c('scenario','region','enduse','year')) %>%
mutate(value = value * frac_tailpipe_emiss,
fuel = if_else(transformation == 'refining','refining',
if_else(transformation == 'gas processing','natural gas',NA_character_)),
direct = fuel) %>%
select(-frac_tailpipe_emiss,-fuel) %>%
filter(year >= 2005)-> trn_tailpipe_CO2_joined
View(trn_tailpipe_CO2_joined)
View(trn_tailpipe_CO2_joined)
write.csv(trn_tailpipe_CO2_joined,'trn_tailpipe_CO2_joined.csv')
